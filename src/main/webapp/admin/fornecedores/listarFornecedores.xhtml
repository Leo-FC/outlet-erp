<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
    <title>Lista de Fornecedores</title>
    <style type="text/css">
        body {
            background-color: #f4f6f8;
            font-family: Arial, sans-serif;
        }
    </style>
</h:head>
<h:body>
    <h:form id="formFornecedores">
        <p:growl id="growl" showDetail="true" />

        <p:panel header="Fornecedores Cadastrados">
            <p:dataTable id="tabelaFornecedores" widgetVar="tabelaFornecedoresWV"
                         value="#{fornecedorBean.fornecedores}" var="f"
                         paginator="true" rows="10"
                         emptyMessage="Nenhum fornecedor encontrado.">

                <p:column headerText="Razão Social" filterBy="#{f.razaoSocial}" filterMatchMode="contains">
                    <h:outputText value="#{f.razaoSocial}" />
                </p:column>
                
                <p:column headerText="CNPJ" filterBy="#{f.cnpjFormatado}" filterMatchMode="contains">
                    <h:outputText value="#{f.cnpjFormatado}" />
                </p:column>

                <p:column headerText="Email da Empresa" filterBy="#{f.email}" filterMatchMode="contains">
                     <h:outputText value="#{f.email}" />
                </p:column>
                
                <p:column headerText="Status" filterBy="#{f.ativo}" filterMatchMode="exact" style="width:150px; text-align:center;">
                    <f:facet name="filter">
                        <p:selectOneMenu onchange="PF('tabelaFornecedoresWV').filter()">
                            <f:selectItem itemLabel="Todos" itemValue="#{null}" noSelectionOption="true" />
                            <f:selectItem itemLabel="Ativo" itemValue="true" />
                            <f:selectItem itemLabel="Inativo" itemValue="false" />
                        </p:selectOneMenu>
                    </f:facet>
                    <p:tag styleClass="#{f.ativo ? 'ui-tag-success' : 'ui-tag-danger'}"
                           value="#{f.ativo ? 'Ativo' : 'Inativo'}" icon="#{f.ativo ? 'pi pi-check' : 'pi pi-times'}" />
                </p:column>

                <p:column headerText="Ações" width="100" style="text-align: center;">
                    <p:button icon="pi pi-pencil" styleClass="ui-button-info ui-button-flat"
                              outcome="editarFornecedor.xhtml?id=#{f.idFornecedor}"
                              title="Editar" />
                    
                    <p:commandButton icon="pi pi-trash" title="Desativar"
                                     actionListener="#{fornecedorBean.prepararExclusao(f)}"
                                     oncomplete="PF('confirmacaoExclusao').show()"
                                     update=":formConfirmacao"
                                     styleClass="ui-button-danger ui-button-flat" />
                </p:column>
            </p:dataTable>
        </p:panel>
        
        <div style="margin-top: 15px; text-align: center; display: flex; justify-content: center; gap: 15px;">
            <p:button value="Voltar" outcome="/admin/painelAdmin.xhtml" icon="pi pi-arrow-left" styleClass="ui-button-secondary"/>
            <p:button value="Novo Fornecedor" outcome="cadastrarFornecedor.xhtml" icon="pi pi-plus" styleClass="ui-button-success"/>
        </div>
    </h:form>

    <p:confirmDialog widgetVar="confirmacaoExclusao" header="Confirmação de Exclusão Lógica" 
                     message="Tem certeza que deseja desativar o fornecedor '#{fornecedorBean.fornecedorParaExcluir.razaoSocial}'?" 
                     icon="pi pi-exclamation-triangle" appendTo="@(body)">
        <h:form id="formConfirmacao">
            <p:commandButton value="Sim, desativar" icon="pi pi-check" 
                             actionListener="#{fornecedorBean.confirmarExclusao}"
                             oncomplete="PF('confirmacaoExclusao').hide()" 
                             update=":formFornecedores:tabelaFornecedores :formFornecedores:growl" 
                             styleClass="ui-button-danger"/>
            <p:commandButton value="Não" type="button" icon="pi pi-times" 
                             onclick="PF('confirmacaoExclusao').hide()" 
                             styleClass="ui-button-secondary"/>
        </h:form>
    </p:confirmDialog>
</h:body>
</html>